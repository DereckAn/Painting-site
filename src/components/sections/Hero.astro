---
/**
 * Hero Section
 * Sección principal con imagen de fondo, título, subtítulo y CTA
 * Totalmente responsivo usando dvh para mejor soporte móvil
 */

import Button from "@/components/ui/Button.astro";
import Container from "@/components/ui/Container.astro";
import { getHeroContent } from "@/lib/tina";

// Load content from Tina CMS
const content = getHeroContent();

const {
  title = content?.title || "Transformamos espacios con elegancia",
  subtitle = content?.subtitle || "Servicios profesionales de pintura",
  ctaText = content?.ctaText || "See our work",
  ctaLink = content?.ctaLink || "#gallery",
  backgroundImage = content?.backgroundImage ||
    "https://images.unsplash.com/photo-1562259949-e8e7689d7828?q=80&w=2000",
} = {};

const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/images/**/*.{png,jpg,jpeg,svg,webp}",
  { eager: true }
);

const bgImg = images[backgroundImage]?.default;
const bgUrl = bgImg ? bgImg.src : backgroundImage;
---

<section
  id="hero"
  class="relative h-[70dvh] min-h-[600px] w-full overflow-hidden"
  aria-label="Hero Section"
>
  <!-- Background Image con Overlay -->
  <div class="absolute inset-0 z-0">
    <!-- Imagen de fondo -->
    <div
      class="absolute inset-0 bg-cover bg-center bg-no-repeat"
      style={{
        backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('${bgUrl}')`,
        backgroundSize: "cover",
        backgroundPosition: "center",
      }}
      role="img"
      aria-label="Pintura profesional con rodillo"
    >
    </div>
  </div>

  <div class="absolute inset-0 bg-black/50"></div>

  <!-- Contenido -->
  <Container class="relative z-10 h-full">
    <div class="flex h-full flex-col items-center justify-center text-center">
      <!-- Título Principal con animación SVG -->
      <div class="relative mb-6">
        <!-- Título que se revela -->
        <h1
          class="relative z-10 max-w-5xl font-poppins text-4xl font-light leading-tight text-white sm:text-5xl md:text-6xl lg:text-7xl"
        >
          {title}
        </h1>
      </div>

      <!-- Subtítulo -->
      <p
        class="mb-10 mt-10 max-w-3xl text-base leading-relaxed text-gray-100 sm:text-lg md:text-xl"
      >
        {subtitle}
      </p>

      <!-- CTA Button -->
      <div class="flex gap-10 xl:gap-20">
        <a
          href="#contact"
          class="nav-link font-poppins text-2xl flex items-center justify-center font-light rounded-sm bg-black text-white px-6 py-2.5 hover:bg-white hover:text-black transition-all duration-300"
        >
          Get a Quote
        </a>
        <Button href={ctaLink} variant="normal">
          <span class="text-2xl font-poppins">{ctaText}</span>
        </Button>
      </div>

      <!-- Scroll Indicator (opcional) -->
      <div class="absolute bottom-10 left-1/2 -translate-x-1/2">
        <a
          href="#services"
          class="flex flex-col items-center gap-2 text-white transition-opacity hover:opacity-100"
          aria-label="Desplazarse a servicios"
        >
          <span class="text-sm uppercase tracking-wider">Descubre más</span>
          <svg
            class="h-6 w-6 animate-bounce"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
            aria-hidden="true"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
          </svg>
        </a>
      </div>
    </div>
  </Container>
</section>

<style>
  /* Asegurar que el hero sea accesible en diferentes dispositivos */
  @media (max-width: 640px) {
    h1 {
      font-size: clamp(2rem, 8vw, 3rem);
    }
  }

  /* Smooth scroll para los enlaces internos */
  html {
    scroll-behavior: smooth;
  }

  /* Animación de líneas de pintura estilo rodillo */
  .paint-bg {
    pointer-events: none;
  }

  .paint-path {
    fill: none;
    stroke: #ffffff;
    stroke-width: 140;
    /* Longitud aproximada del path - ajustar según sea necesario */
    stroke-dasharray: 3000;
    stroke-dashoffset: 3000;
    /* Animar el trazo del path */
    animation: drawPath 3s ease-out forwards;
  }

  /* Animación para dibujar el path (efecto de rodillo pintando) */
  @keyframes drawPath {
    from {
      stroke-dashoffset: 3000;
    }
    to {
      stroke-dashoffset: 0;
    }
  }

  /* Reducir el movimiento para usuarios que lo prefieren */
  @media (prefers-reduced-motion: reduce) {
    .paint-path {
      animation: none;
      stroke-dashoffset: 0;
      stroke-width: 150;
    }
  }
</style>
